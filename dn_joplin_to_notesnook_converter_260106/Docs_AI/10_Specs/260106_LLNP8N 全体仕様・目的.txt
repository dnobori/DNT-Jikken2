このファイルは、このプロジェクトで作成するプログラムの全体仕様・目的を記述したものである。

C# .NET (.NET 6.0) で動作する、以下のプログラムを作れ。



ライブラリの使用は、BCLを基本とするものの、必要に応じて、定評のあるHTMLやMDの読み書きライブラリや画像読み書きライブラリ等を使用することを許容する。しかしながら、それらのライブラリに副作用やバグがありえるので、十分注意すること。画像ファイルの分析は、System.Drawingではなく、ImageSharp を利用すること。

実装にあたって、何か気になる点、正しく動作するかどうか不安な点、実現困難・不能な点があったならば、作成したソースコードの冒頭部分に、「制約事項」としてまとめて記載せよ。


1. プログラムの目的
(1) 「Joplin 3.4.12 for Windows」というノートブック管理アプリで、1 個のノートを「Markdown - Front Matter」形式で出力した 「1 個の Markdown ファイル (先頭部分に、「Front Matter」でメタデータが記載)」を、「Notesnook for Windows v3.3.7」というノートブック管理アプリ に HTML 形式でインポートしたい。

(2) そこで、ソース MD ファイルを、HTML ファイルに変換する C# ライブラリのソースコードを生成する必要がある。ソースコードは [3] の形式のクラスと関数を有するものとする。Convert 関数がその処理を行なう関数である。

- srcMdFileNameFullPath は、入力元の Markdownファイルのフルパスである。

- dstHtmlDirFullPath は、出力先のHTMLファイルを保存すべきディレクトリのフルパスである。保存時にディレクトリがなければ作成せよ。保存先ファイル名は、dstHtmlDirFullPathのディレクトリ内において、かつ、srcMdFileNameFullPath で指定されたファイル名の末尾の「.md」部分 (ファイル名の末尾が「.md」でない場合は、異常なので、致命的なエラーとすること) を「.html」に置換したファイル名とすること。保存先ファイルがすでに存在する場合は、上書きせよ。

- warningsLogFilePath は、Convert 関数の処理の途中で、元のMDのパース処理や解釈処理に際して、何らかのMDファイルの文法問題等の軽微な問題が発生した場合に、その詳細をappend (存在しない場合は新規作成せよ) する警告ログファイルである。

 -- 警告ログファイルに警告を出すときは、まず、「★ 元のファイル名」の形で見だしを書き、次に改行してから、4 文字インデントして (複数行に警告がわたるときはすべての行をインデントせよ) 警告内容を詳しく記載すること。警告内容は英語でも日本語でもよい。警告内容には、元の MD ファイルの何行目あたりのどの部分がどのようにおかしいのか、判明している範囲で記載せよ。最後に、その警告の書き込みが完了したならば、1行、空行の改行を空けろ。

(3) 致命的な問題・エラーが発生した場合は、例外を発生させろ。致命的エラーについては、警告ログファイルへの追記は不要である。

2. Convert 処理の詳細
(1) ソースMDファイルのサンプルを、[1] に示す。出力先HTMLファイルのサンプルを、[2] に示す。すなわち、[1] が srcMdFileNameFullPath として指定されたとき、dstHtmlDirFullPath の出力先に [2] のHTMLが出力されるようなプログラムを作れ。

(2) 出力HTMLは、UTF-8、BOM付きとする。改行コードは、LFとする。

(3) 入力MDは、UTF-8であるが、BOMはある場合とない場合とがあり、改行コードも統一されていない。

(4) 入力MDには、Front Matter部が必ず存在する。title、updated,createdの3項目が必ず存在する。存在しない場合は、致命的なエラーとせよ。titleは任意の文字列、updatedとcreatedは「2026-01-04 13:36:31Z」の形式のUTC日時データである。この形式に適合していない文字列が入っている場合は、致命的なエラーとせよ。titleが0文字の場合も、致命的なエラーとせよ。

 - titleは、出力HTMLのtitleヘッダ部分の文字列となる。詳しくは [1], [2] を比較検討して把握せよ。
 
 - updatedとcreatedは、出力HTMLの「<meta name="created-at"」や「<meta name="updated-at"」の内容となる。ただし、表記規則が [1] と異なるので注意せよ。詳しくは [1], [2] を比較検討して把握せよ。

(5) 入力MDの本文部分は、おおむね普通の Markdown であるが、「Joplin 3.4.12 for Windows」というノートブック管理アプリで、1 個のノートを「Markdown - Front Matter」形式で出力した形式であるため、同アプリ固有の特殊な形式や表記があるかも知れない。これについては、インターネットで調査した上で、適切に対処せよ。

(6) 入力MDには、添付ファイル (PDFなど) が付いていることがある。たとえば、[1] の「[(2) フェーズ１、２、３の図面.pdf](../_resources/%282%29%20フェーズ１、２、３の図面.pdf)」の部分である。

 - 入力 MD では、すべての添付ファイルは、「../_resources/」という相対ディレクトリに存在することとなっている。この [1] の例では、「../_resources/%282%29%20フェーズ１、２、３の図面.pdf」というファイルが、MDファイルの存在するディレクトリからみた相対パス「../_resources/」に存在しているはずである。そこで、添付ファイルの存在を確認せよ。もし添付ファイルがなければ、致命的なエラーとせよ。また、添付ファイルのパスとして、MDにおいて「../_resources/」という相対ディレクトリ以外のパスが指定されている場合は、これも、致命的なエラーとせよ。

 - 出力 HTML では、すべての添付ファイルは、HTMLファイルの出力先ディレクトリからみた相対パス「./attachments/」のディレクトリに保存されるものとして扱え。そして、添付ファイルの名前は、入力MDにおける添付ファイルの名前を使用せず、代わりに、「attachment_<乱数>.<拡張子>」というファイル名とせよ。そして、実際に、入力添付ファイルを、HTMLファイルの出力先ディレクトリからみた相対パス「./attachments/」のディレクトリに、その出力ファイル名で保存 (コピー) せよ。(ディレクトリがない場合は作成せよ。) <乱数>は、「a3f09c1d7e4b8a2c6d1f0b9e3a7c2d5f」のような、16バイトのバイナリ列 (決して重複しないようきちんとした乱数で生成せよ) をhexとして32ビット英数字に変換した文字列とせよ。<拡張子> は、元のファイルの拡張子と同じとせよ。ただし、ファイル名部分は、すべて小文字とせよ (出力 HTML ファイル名でそのファイルを参照する部分についても同様)。
 
 - 出力 HTML では、添付ファイルを指し示す際のハイパーリンクは、少し特殊な <p> タグで囲むこと。詳しくは [1], [2] を比較検討して把握せよ。
 
 - これらのルールに基づき、出力 HTML では、[1] の上記添付ファイル部分のサンプルが、[2] の例における 「<p data-spacing="double"><a href="./attachments/attachment_a3f09c1d7e4b8a2c6d1f0b9e3a7c2d5f.pdf" title="(2) フェーズ１、２、３の図面.pdf">(2) フェーズ１、２、３の図面.pdf</a></p>」のように変換されることになる。a タグの title 文字列と HTML 表示文字列は、元の MD におけるリンクの表示文字列とせよ。ただし、リンクの表示文字列とすべき部分が、0 文字あるいは空白文字 (スペースなどだけで構成されている) である場合は、代わりに、「attachment_<乱数>.<拡張子>」というようなファイル名部分を表示文字列とせよ。(そうしなければユーザーがクリックできないか認識できないため。)
 
(7) 入力 MD において、https:// や http:// 、 ftp:// で始まるリンク先に対してリンクが貼られている場合は、Web サイトへのハイパーリンクであるので、(6) のように扱うことなくハイパーリンクとして処理せよ。すなわち、MD のリンク機能で、「https:// や http:// 、 ftp:// で始まるリンク先に対してリンクが貼られている場合」はハイパーリンクとして扱い、それ以外の場合は (6) の扱いをせよ。

(8) 入力MDには、画像が埋め込まれていることがある。たとえば、[1] の「![](../_resources/8b22620b67b592792bb899207deecf3f.png)」の部分である。

 - 入力 MD では、すべての埋め込み画像は、「../_resources/」という相対ディレクトリに存在することとなっている。この [1] の例では、「../_resources/8b22620b67b592792bb899207deecf3f.png」というファイルが、MDファイルの存在するディレクトリからみた相対パス「../_resources/」に存在しているはずである。そこで、添付ファイルの存在を確認せよ。もし添付ファイルがなければ、致命的なエラーとせよ。また、添付ファイルのパスとして、MDにおいて「../_resources/」という相対ディレクトリ以外のパスが指定されている場合は、これも、致命的なエラーとせよ。

 - 出力 HTML では、すべての画像ファイルは、HTMLファイルの出力先ディレクトリからみた相対パス「./attachments/」のディレクトリに保存されるものとして扱え。そして、添付ファイルの名前は、入力MDにおける添付ファイルの名前をそのまま使用せよ (この点は (6) と異なる)。そして、実際に、入力添付ファイルを、HTMLファイルの出力先ディレクトリからみた相対パス「./attachments/」のディレクトリに、その出力ファイル名で保存 (コピー) せよ。(ディレクトリがない場合は作成せよ。) ただし、ファイル名部分は、すべて小文字とせよ (出力 HTML ファイル名でそのファイルを参照する部分についても同様)。
 
 - 画像においては、実際にその画像ファイル (jpeg, png 等) を読み込み、width, height を取得し、これを出力 HTML 内の img タグで指定せよ。[2] のサンプルには、width, height が無いことに注意せよ。実際には width, height を出力すること。・・・[260106_ANNK2H]

 - 出力 HTML では、画像を指し示す際の img タグは、少し特殊な <p> タグで囲むこと。詳しくは [1], [2] を比較検討して把握せよ。
 
 - これらのルールに基づき、出力 HTML では、[1] の上記画像埋め込み部分のサンプルが、[2] の例における 「「<p data-spacing="single"><span class="image-container" alt="8b22620b67b592792bb899207deecf3f.png"><img class="" src="./attachments/8b22620b67b592792bb899207deecf3f.png" alt="8b22620b67b592792bb899207deecf3f.png"></span></p>」」のように変換されることになる (ただし、[260106_ANNK2H] 注意)。各 alt タグの文字列は、画像ファイル名 (ディレクトリ名をのぞく) と同一とせよ。

(9) 入力MDには、複数行コードブロックと、インラインコードブロックとが出現する。[1] のサンプルにもこれらが両方含まれている。[2] のように出力すること。

(9-2) 入力MDには、本文中 (非コードブロック) 部分に、Web URL (http:// や https:// など) が、MDのリンクタグを用いることなく、本文中にそのまま出てくることがある。このような場合は、自動でハイパーリンクに変換すること。[1] でも、「BIOS 初期設定 https://www.yahoo.com/」という行が、[2] では、「<p data-spacing="double">BIOS 初期設定 <a target="_blank" rel="noopener noreferrer nofollow" spellcheck="false" href="https://www.yahoo.com/" title="https://www.yahoo.com/">https://www.yahoo.com/</a></p>」に変換されているが、これに倣って変換 (自動ハイパーリンク貼り付け) せよ。

(10) 入力MDにおける文字列において、MDとしてエスケープされている部分は、適切に解釈すること。また、出力HTML化する際には、適切にエスケープすること。

(11) 出力HTMLは、[2] のサンプルのように、きれいにインデントして出力せよ。

(12) 元のMDにおいて、間隔の短い改行と、間隔の長い改行の両方が出現する。それぞれ、HTMLで適切に表現せよ。ただし、間隔の短い改行についても必ず <p> タグで1つのブロックとしなければならない。これは、出力先HTMLをインポートするNotesnook側の制約でそのようになっている。[2] のサンプルでは、「<p data-spacing="double">」と「<p data-spacing="single">」が登場することに注意する。詳しくは [1], [2] を比較検討して把握せよ。

(12-2) 元のMDには、箇条書き、ネスト付き箇条書き、箇条書きの番号付きのもの、チェックボックス、見出し、水平線、各種書式指定 (太字、斜体、下線)、その他の HTML タグを用いたより詳細な書式指定等が登場する可能性がある。詳しくは [1], [2] を比較検討して把握せよ。ただし、[1], [2] に出力しないパターンもあるので、できるだけ多くのパターンに対応できるように実装せよ。

(12-3) 元のMDの本文部分に、<br>系や &nbsp; 等の改行や空白タグが含まれている場合がありえる。これらはそれらの意味を解釈してHTMLに反映せよ。

(12-4) 元のMDの本文中 (MDの表記としての空白文字列ではなく、それを解釈した後の本文部分) に、複数空白があるような場合は、空白文字で何か重要な情報を表現している (インデントなど) 可能性が高いので、それは、HTML 内でも正しく空白として表現せよ。

(13) 上記に述べられていないルールであって、入力MDから出力HTMLに変換する際のルールは、[1], [2] を比較検討して把握せよ。特に、[2] におけるいくつかの当初から埋め込まれているタグ (例: 「<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />」や「<link rel="stylesheet" href="https://app.notesnook.com/assets/editor-styles.css?d=1690887574068">」のような部分) は、本プログラムにおいても、[2] に倣って出力するようにせよ。




--- [3] ここから ---
public static class JoplinMdToNotesnookHtmlExporter
{
    public static void Convert(string srcMdFileNameFullPath, string dstHtmlDirFullPath, string warningsLogFilePath);
}

--- [3] ここまで ---


--- [1] ここから ---
---
title: 09_Simply DELL PowerEdge R420 中古メモ
updated: 2026-01-04 13:36:31Z
created: 2021-08-18 15:46:21Z
---

こんにちはねこさん

- BIOS 初期設定 https://www.yahoo.com/   
    iDRAC 初期設定 (IP アドレス)
- あああ  
    いい  
    <br/>
- うう

1.  ちちち  
    ちちち
2.  **こここ***あいうえお*~~かきくけこ~~***さそすせそ***~~**たちつてと*なにぬねの***~~はひふへほ  
    いいい
3.  aaaa

- [ ] cb1
- [x] cb2  
    あああ
- [ ] cb3

[(2) フェーズ１、２、３の図面.pdf](../_resources/%282%29%20フェーズ１、２、３の図面.pdf)

ソースコード！！

```
#include <stdio.h>
int main()
{
    printf("Hello World\n");
    return 0;
}
```

BIOS **初期**設定  
~~iDRAC 初期設定 (IP アドレス)~~  
<ins>iDRAC 更新 (iDRAC の HTML から)</ins>  
***テスト１***  
**テスト２**  
~~***USB 等から仮 Windows を起動***~~  
~~**BIOS 更新 (仮 Windows から)**~~  
RAID *ファームウェア*更新 (仮 Windows から)  
RAID ~~仮想ドライブ全部削除~~・初期化 (BIOS から きれいな画面)  
RAID ~~**HDD・SSD 設定**~~  
※ RAID コントローラの BIOS にも入ってさらなる設定の余地がないかどうかみる  
iDRAC の設定を Web で吟味

# 見出し１

## 見出し２

### 見出し３

ねこ

* * *

購入物  
メンテ用USB DVD  
借Windows起動用USB SSD `123` `456` ねこねこ

&nbsp;

初期バージョン  
BIOS 1.10 v2.3.3

![](../_resources/8b22620b67b592792bb899207deecf3f.png)

アップデート後  
BIOS 1.10 2.9.0

![](../_resources/c708b681e22ed20e2d61f2adc60706c0.png)

![](../_resources/d9b692227c978e07e6a3b505ca1af950.png)

![](../_resources/cf520cdb33d8955d3eccee26479b92b1.png)
--- [1] ここまで ---

--- [2] ここから ---
<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
    <title>09_Simply DELL PowerEdge R420 中古メモ</title>
    <meta name="created-at" content="08-19-2021 12:46 AM" />
    <meta name="updated-at" content="01-04-2026 11:27 PM" />
    <link rel="stylesheet" href="https://app.notesnook.com/assets/editor-styles.css?d=1690887574068">
</head>

<body>
    <p data-spacing="double">こんにちはねこさん</p>
    <ul>
        <li>
            <p data-spacing="double">BIOS 初期設定 <a target="_blank" rel="noopener noreferrer nofollow" spellcheck="false" href="https://www.yahoo.com/" title="https://www.yahoo.com/">https://www.yahoo.com/</a></p>
            <p data-spacing="single">iDRAC 初期設定 (IP アドレス)</p>
        </li>
        <li>
            <p data-spacing="double">あああ</p>
            <p data-spacing="single">いい</p>
        </li>
        <li>
            <p data-spacing="double">うう</p>
        </li>
    </ul>
    <ol>
        <li>
            <p data-spacing="double">ちちち</p>
            <p data-spacing="single">ちちち</p>
        </li>
        <li>
            <p data-spacing="double"><strong>こここ</strong><em>あいうえお</em><s>かきくけこ</s><strong><em>さそすせそ</em></strong>~~<strong>たちつてと<em>なにぬねの</em></strong>~~はひふへほ</p>
            <p data-spacing="single">いいい</p>
        </li>
        <li>
            <p data-spacing="double">aaaa</p>
        </li>
    </ol>
    <ul class="simple-checklist">
        <li class="simple-checklist--item">
            <p data-spacing="double">cb1</p>
        </li>
        <li class="checked simple-checklist--item">
            <p data-spacing="double">cb2</p>
            <p data-spacing="single">あああ</p>
        </li>
        <li class="simple-checklist--item">
            <p data-spacing="double">cb3</p>
        </li>
    </ul>
    <p data-spacing="double"><a href="./attachments/attachment_a3f09c1d7e4b8a2c6d1f0b9e3a7c2d5f.pdf" title="(2) フェーズ１、２、３の図面.pdf">(2) フェーズ１、２、３の図面.pdf</a></p>
    <p data-spacing="double">ソースコード！！</p>
    <pre data-indent-type="space" data-indent-length="2"><code>#include &lt;stdio.h&gt;
int main()
{
    printf("Hello World\n");
    return 0;
}</code></pre>
    <p data-spacing="double">BIOS <strong>初期</strong>設定</p>
    <p data-spacing="single"><s>iDRAC 初期設定 (IP アドレス)</s></p>
    <p data-spacing="single">iDRAC 更新 (iDRAC の HTML から)</p>
    <p data-spacing="single"><strong><em>テスト１</em></strong></p>
    <p data-spacing="single"><strong>テスト２</strong></p>
    <p data-spacing="single"><strong><em><s>USB 等から仮 Windows を起動</s></em></strong></p>
    <p data-spacing="single"><strong><s>BIOS 更新 (仮 Windows から)</s></strong></p>
    <p data-spacing="single">RAID <em>ファームウェア</em>更新 (仮 Windows から)</p>
    <p data-spacing="single">RAID <s>仮想ドライブ全部削除</s>・初期化 (BIOS から きれいな画面)</p>
    <p data-spacing="single">RAID <strong><s>HDD・SSD 設定</s></strong></p>
    <p data-spacing="single">※ RAID コントローラの BIOS にも入ってさらなる設定の余地がないかどうかみる</p>
    <p data-spacing="single">iDRAC の設定を Web で吟味</p>
    <h1>見出し１</h1>
    <h2>見出し２</h2>
    <h3>見出し３</h3>
    <p data-spacing="double">ねこ</p>
    <hr>
    <p data-spacing="double">購入物</p>
    <p data-spacing="single">メンテ用USB DVD</p>
    <p data-spacing="single">借Windows起動用USB SSD <code spellcheck="false">123</code> <code spellcheck="false">456</code> ねこねこ</p>
    <p data-spacing="double">&nbsp;</p>
    <p data-spacing="double">初期バージョン</p>
    <p data-spacing="single">BIOS 1.10 v2.3.3</p>
    <p data-spacing="single"><span class="image-container" alt="8b22620b67b592792bb899207deecf3f.png"><img class="" src="./attachments/8b22620b67b592792bb899207deecf3f.png" alt="8b22620b67b592792bb899207deecf3f.png"></span></p>
    <p data-spacing="double">アップデート後</p>
    <p data-spacing="single">BIOS 1.10 2.9.0</p>
    <p data-spacing="single"><span class="image-container" alt="c708b681e22ed20e2d61f2adc60706c0.png"><img class="" src="./attachments/c708b681e22ed20e2d61f2adc60706c0.png" alt="c708b681e22ed20e2d61f2adc60706c0.png"></span></p>
    <p data-spacing="single"><span class="image-container" alt="d9b692227c978e07e6a3b505ca1af950.png"><img class="" src="./attachments/d9b692227c978e07e6a3b505ca1af950.png" alt="d9b692227c978e07e6a3b505ca1af950.png"></span></p>
    <p data-spacing="single"><span class="image-container" alt="cf520cdb33d8955d3eccee26479b92b1.png"><img class="" src="./attachments/cf520cdb33d8955d3eccee26479b92b1.png" alt="cf520cdb33d8955d3eccee26479b92b1.png"></span></p>
</body>

</html>
--- [2] ここまで ---


